{"ast":null,"code":"var requestRoot = require('request');\n\nvar request = requestRoot;\n\nvar _ = require('lodash');\n\nvar generateJwt = require('./generateJwt');\n\nvar pkg = require('../package.json');\n\nvar Stream = require('./stream');\n\nvar Broadcast = require('./broadcast');\n\nvar defaultConfig = {\n  apiKey: null,\n  apiSecret: null,\n  apiUrl: 'https://api.opentok.com',\n  endpoints: {\n    createSession: '/session/create',\n    getStream: '/v2/project/<%apiKey%>/session/<%sessionId%>/stream/<%streamId%>',\n    listStreams: '/v2/project/<%apiKey%>/session/<%sessionId%>/stream',\n    setArchiveLayout: '/v2/project/<%apiKey%>/archive/<%archiveId%>/layout',\n    setStreamClassLists: '/v2/project/<%apiKey%>/session/<%sessionId%>/stream',\n    dial: '/v2/project/<%apiKey%>/dial',\n    playDTMFToSession: '/v2/project/<%apiKey%>/session/<%sessionId%>/play-dtmf',\n    playDTMFToClient: '/v2/project/<%apiKey%>/session/<%sessionId%>/connection/<%connectionId%>/play-dtmf',\n    forceMuteStream: '/v2/project/<%apiKey%>/session/<%sessionId%>/stream/<%streamId%>/mute',\n    forceMute: '/v2/project/<%apiKey%>/session/<%sessionId%>/mute',\n    startBroadcast: '/v2/project/<%apiKey%>/broadcast',\n    stopBroadcast: '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>/stop',\n    getBroadcast: '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>',\n    patchBroadcast: '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>/streams',\n    setBroadcastLayout: '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>/layout',\n    listBroadcasts: '/v2/project/<%apiKey%>/broadcast'\n  },\n  request: {\n    timeout: 20000 // 20 seconds\n\n  },\n  auth: {\n    expire: 300\n  }\n};\n\nvar Client = function (c) {\n  this.c = {};\n  this.config(_.defaults(c, defaultConfig));\n};\n\nClient.prototype.config = function (c) {\n  _.merge(this.c, c);\n\n  if (this.c.endpoints && this.c.endpoints.dial && this.c.apiKey) {\n    this.c.endpoints.dial = this.c.endpoints.dial.replace(/<%apiKey%>/g, this.c.apiKey);\n  }\n\n  if ('request' in this.c) {\n    request = requestRoot.defaults(this.c.request);\n  }\n\n  return this.c;\n};\n\nClient.prototype.createSession = function (opts, cb) {\n  request.post({\n    // TODO: only works while apiUrl is always up to the domain, without the ending slash\n    url: this.c.apiUrl + this.c.endpoints.createSession,\n    form: opts,\n    json: true,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) {\n      return cb(new Error('The request failed: ' + err));\n    } // handle client errors\n\n\n    if (resp.statusCode === 403) {\n      return cb(new Error('An authentication error occurred: (' + resp.statusCode + ') ' + JSON.stringify(body)));\n    } // handle server errors\n\n\n    if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n      return cb(new Error('A server error occurred: (' + resp.statusCode + ') ' + JSON.stringify(body)));\n    } // check if the returned object is valid JSON\n\n\n    if (typeof body !== 'object') {\n      return cb(new Error('Server returned invalid JSON'));\n    }\n\n    return cb(null, body);\n  });\n};\n\nClient.prototype.startArchive = function () {};\n\nClient.prototype.stopArchive = function () {};\n\nClient.prototype.getArchive = function () {};\n\nClient.prototype.listArchives = function () {};\n\nClient.prototype.deleteArchive = function () {};\n\nClient.prototype.playDTMF = function (opts, cb) {\n  var url;\n\n  if (opts.sessionId) {\n    url = this.c.apiUrl + this.c.endpoints.playDTMFToSession.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%sessionId%>/g, opts.sessionId);\n  }\n\n  if (opts.connectionId) {\n    url = this.c.apiUrl + this.c.endpoints.playDTMFToClient.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%sessionId%>/g, opts.sessionId).replace(/<%connectionId%>/g, opts.connectionId);\n  }\n\n  request.post({\n    url: url,\n    json: {\n      digits: opts.digits\n    },\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err));\n\n    if (resp.statusCode === 200) {\n      // Success\n      return cb(null);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.forceMuteStream = function (opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.forceMuteStream.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%sessionId%>/g, opts.sessionId).replace(/<%streamId%>/g, opts.streamId);\n  request.post({\n    url: url,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err));\n\n    if (resp.statusCode === 200) {\n      // Success\n      return cb(null);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.forceMuteAll = function (opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.forceMute.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%sessionId%>/g, opts.sessionId);\n  opts.options.active = true;\n  request.post({\n    url: url,\n    json: opts.options,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err));\n\n    if (resp.statusCode === 200) {\n      // Success\n      return cb(null);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.disableForceMute = function (opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.forceMute.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%sessionId%>/g, opts.sessionId);\n  var options = {\n    active: false\n  };\n  request.post({\n    url: url,\n    json: options,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err));\n\n    if (resp.statusCode === 200) {\n      // Success\n      return cb(null);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.setArchiveLayout = function setArchiveLayout(opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.setArchiveLayout.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%archiveId%>/g, opts.archiveId);\n  request.put({\n    url: url,\n    headers: this.generateHeaders(),\n    json: true,\n    body: {\n      type: opts.type,\n      stylesheet: opts.stylesheet || undefined,\n      screenshareType: opts.screenshareType || undefined\n    }\n  }, function requestCallback(err, resp, body) {\n    if (err) {\n      return cb(new Error('The request failed: ' + err));\n    }\n\n    if (resp.statusCode === 200) {\n      return cb(null, body);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n  });\n};\n\nClient.prototype.startBroadcast = function (opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.startBroadcast.replace(/<%apiKey%>/g, this.c.apiKey);\n  request.post({\n    url: url,\n    json: opts,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err));\n\n    if (resp.statusCode === 200) {\n      // Success\n      return cb(null, JSON.stringify(body));\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.patchBroadcast = function patchBroadcast(broadcastId, opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.patchBroadcast.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%broadcastId%>/g, broadcastId);\n  request.patch({\n    url: url,\n    json: opts,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed'));\n\n    if (resp.statusCode === 200) {\n      return cb(null, JSON.stringify(body));\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.stopBroadcast = function (broadcastId, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.stopBroadcast.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%broadcastId%>/g, broadcastId);\n  request.post({\n    url: url,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err));\n\n    if (resp.statusCode === 200) {\n      // Success\n      return cb(null, body);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.parse(body).message));\n  });\n};\n\nClient.prototype.getBroadcast = function getBroadcast(broadcastId, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.getBroadcast.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%broadcastId%>/g, broadcastId);\n  request.get({\n    url: url,\n    headers: this.generateHeaders()\n  }, function requestCallback(err, resp, body) {\n    if (err) {\n      return cb(new Error('The request failed: ' + err));\n    }\n\n    if (resp.statusCode === 200) {\n      return cb(null, body);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + body ? body.message : ''));\n  });\n};\n\nClient.prototype.listBroadcasts = function listBroadcasts(queryString, cb) {\n  var baseUrl = this.c.apiUrl + this.c.endpoints.listBroadcasts.replace(/<%apiKey%>/g, this.c.apiKey);\n  var url = queryString.length > 0 ? baseUrl + '?' + queryString : baseUrl;\n  var parsedBody;\n  request.get({\n    url: url,\n    headers: this.generateHeaders()\n  }, function requestCallback(err, resp, body) {\n    if (err) {\n      return cb(new Error('The request failed: ' + err));\n    }\n\n    if (resp.statusCode === 200) {\n      parsedBody = JSON.parse(body);\n      return cb(null, parsedBody.items.map(function itemIterator(item) {\n        return new Broadcast(Client, JSON.stringify(item));\n      }), parsedBody.count);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + body ? body.message : ''));\n  });\n};\n\nClient.prototype.setBroadcastLayout = function setBroadcastLayout(opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.setBroadcastLayout.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%broadcastId%>/g, opts.broadcastId);\n  request.put({\n    url: url,\n    headers: this.generateHeaders(),\n    json: true,\n    body: {\n      type: opts.type,\n      stylesheet: opts.stylesheet || undefined,\n      screenshareType: opts.screenshareType || undefined\n    }\n  }, function requestCallback(err, resp, body) {\n    if (err) {\n      return cb(new Error('The request failed: ' + err));\n    }\n\n    if (resp.statusCode === 200) {\n      return cb(null, body);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n  });\n};\n\nClient.prototype.setStreamClassLists = function setStreamClassLists(sessionId, classListArray, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.setStreamClassLists.replace(/<%apiKey%>/, this.c.apiKey).replace(/<%sessionId%>/g, sessionId);\n  request.put({\n    url: url,\n    headers: this.generateHeaders(),\n    json: true,\n    body: {\n      items: classListArray\n    }\n  }, function requestCallback(err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err)); // handle client errors\n\n    switch (resp.statusCode) {\n      case 200:\n        return cb(null, body);\n\n      case 400:\n        return cb(new Error('Invalid session ID or stream ID (400).'));\n\n      case 403:\n        return cb(new Error('Invalid API key or secret (403).'));\n\n      default:\n        if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n          // handle server errors\n          return cb(new Error('A server error occurred: (' + resp.statusCode + ') ' + JSON.stringify(body)));\n        }\n\n    }\n\n    return cb(new Error('An unexpected error occurred: (' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.dial = function (opts, cb) {\n  request.post({\n    // TODO: only works while apiUrl is always up to the domain, without the ending slash\n    url: this.c.apiUrl + this.c.endpoints.dial,\n    json: opts,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed: ' + err)); // handle client errors\n\n    if (resp.statusCode === 400) {\n      if (body.code === 15204) {\n        return cb(new Error('SIP Interconnect for Video is not enabled in this project'));\n      }\n\n      return cb(new Error('Bad session ID, token, SIP credentials, or SIP URI (sip:user@domain.tld)'));\n    }\n\n    if (resp.statusCode === 403) {\n      return cb(new Error('Invalid API key or secret'));\n    }\n\n    if (resp.statusCode === 409) {\n      return cb(new Error('Only Routed Sessions are allowed to initiate SIP Calls.'));\n    } // handle server errors\n\n\n    if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n      return cb(new Error('A server error occurred: (' + resp.statusCode + ') ' + body));\n    } // Parse data from server\n\n\n    return cb(null, body);\n  });\n};\n\nClient.prototype.getStream = function getStream(sessionId, streamId, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.getStream.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%streamId%>/g, streamId).replace(/<%sessionId%>/g, sessionId);\n  request.get({\n    url: url,\n    headers: this.generateHeaders()\n  }, function requestCallback(err, resp, body) {\n    if (err) {\n      return cb(new Error('The request failed: ' + err));\n    }\n\n    if (resp.statusCode === 200) {\n      return cb(null, body);\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n  });\n};\n\nClient.prototype.listStreams = function listStreams(sessionId, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.listStreams.replace(/<%apiKey%>/g, this.c.apiKey).replace(/<%sessionId%>/g, sessionId);\n  request.get({\n    url: url,\n    headers: this.generateHeaders()\n  }, function requestCallback(err, resp, body) {\n    if (err) {\n      return cb(new Error('The request failed: ' + err));\n    }\n\n    if (resp.statusCode === 200) {\n      return cb(null, JSON.parse(body).items.map(function itemIterator(item) {\n        return new Stream(JSON.stringify(item));\n      }));\n    }\n\n    return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n  });\n};\n\nClient.prototype.generateHeaders = function () {\n  return {\n    'User-Agent': 'OpenTok-Node-SDK/' + pkg.version + (this.c.uaAddendum ? ' ' + this.c.uaAddendum : ''),\n    'X-OPENTOK-AUTH': generateJwt(this.c),\n    Accept: 'application/json'\n  };\n};\n\nmodule.exports = Client;","map":{"version":3,"names":["requestRoot","require","request","_","generateJwt","pkg","Stream","Broadcast","defaultConfig","apiKey","apiSecret","apiUrl","endpoints","createSession","getStream","listStreams","setArchiveLayout","setStreamClassLists","dial","playDTMFToSession","playDTMFToClient","forceMuteStream","forceMute","startBroadcast","stopBroadcast","getBroadcast","patchBroadcast","setBroadcastLayout","listBroadcasts","timeout","auth","expire","Client","c","config","defaults","prototype","merge","replace","opts","cb","post","url","form","json","headers","generateHeaders","err","resp","body","Error","statusCode","JSON","stringify","startArchive","stopArchive","getArchive","listArchives","deleteArchive","playDTMF","sessionId","connectionId","digits","streamId","forceMuteAll","options","active","disableForceMute","archiveId","put","type","stylesheet","undefined","screenshareType","requestCallback","message","broadcastId","patch","parse","get","queryString","baseUrl","length","parsedBody","items","map","itemIterator","item","count","classListArray","code","version","uaAddendum","Accept","module","exports"],"sources":["/Users/megnabiederman/node_modules/opentok/lib/client.js"],"sourcesContent":["var requestRoot = require('request');\nvar request = requestRoot;\nvar _ = require('lodash');\nvar generateJwt = require('./generateJwt');\nvar pkg = require('../package.json');\nvar Stream = require('./stream');\nvar Broadcast = require('./broadcast');\nvar defaultConfig = {\n  apiKey: null,\n  apiSecret: null,\n  apiUrl: 'https://api.opentok.com',\n  endpoints: {\n    createSession: '/session/create',\n    getStream:\n      '/v2/project/<%apiKey%>/session/<%sessionId%>/stream/<%streamId%>',\n    listStreams: '/v2/project/<%apiKey%>/session/<%sessionId%>/stream',\n    setArchiveLayout: '/v2/project/<%apiKey%>/archive/<%archiveId%>/layout',\n    setStreamClassLists: '/v2/project/<%apiKey%>/session/<%sessionId%>/stream',\n    dial: '/v2/project/<%apiKey%>/dial',\n    playDTMFToSession: '/v2/project/<%apiKey%>/session/<%sessionId%>/play-dtmf',\n    playDTMFToClient:\n      '/v2/project/<%apiKey%>/session/<%sessionId%>/connection/<%connectionId%>/play-dtmf',\n    forceMuteStream:\n      '/v2/project/<%apiKey%>/session/<%sessionId%>/stream/<%streamId%>/mute',\n    forceMute: '/v2/project/<%apiKey%>/session/<%sessionId%>/mute',\n    startBroadcast: '/v2/project/<%apiKey%>/broadcast',\n    stopBroadcast: '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>/stop',\n    getBroadcast: '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>',\n    patchBroadcast: '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>/streams',\n    setBroadcastLayout:\n      '/v2/project/<%apiKey%>/broadcast/<%broadcastId%>/layout',\n    listBroadcasts: '/v2/project/<%apiKey%>/broadcast'\n  },\n  request: {\n    timeout: 20000 // 20 seconds\n  },\n  auth: {\n    expire: 300\n  }\n};\n\nvar Client = function (c) {\n  this.c = {};\n  this.config(_.defaults(c, defaultConfig));\n};\n\nClient.prototype.config = function (c) {\n  _.merge(this.c, c);\n  if (this.c.endpoints && this.c.endpoints.dial && this.c.apiKey) {\n    this.c.endpoints.dial = this.c.endpoints.dial.replace(\n      /<%apiKey%>/g,\n      this.c.apiKey\n    );\n  }\n  if ('request' in this.c) {\n    request = requestRoot.defaults(this.c.request);\n  }\n\n  return this.c;\n};\n\nClient.prototype.createSession = function (opts, cb) {\n  request.post(\n    {\n      // TODO: only works while apiUrl is always up to the domain, without the ending slash\n      url: this.c.apiUrl + this.c.endpoints.createSession,\n      form: opts,\n      json: true,\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) {\n        return cb(new Error('The request failed: ' + err));\n      }\n\n      // handle client errors\n      if (resp.statusCode === 403) {\n        return cb(new Error('An authentication error occurred: (' +\n              resp.statusCode +\n              ') ' +\n              JSON.stringify(body)));\n      }\n\n      // handle server errors\n      if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n        return cb(new Error('A server error occurred: (' +\n              resp.statusCode +\n              ') ' +\n              JSON.stringify(body)));\n      }\n\n      // check if the returned object is valid JSON\n      if (typeof body !== 'object') {\n        return cb(new Error('Server returned invalid JSON'));\n      }\n\n      return cb(null, body);\n    }\n  );\n};\n\nClient.prototype.startArchive = function () {};\n\nClient.prototype.stopArchive = function () {};\n\nClient.prototype.getArchive = function () {};\n\nClient.prototype.listArchives = function () {};\n\nClient.prototype.deleteArchive = function () {};\n\nClient.prototype.playDTMF = function (opts, cb) {\n  var url;\n\n  if (opts.sessionId) {\n    url =\n      this.c.apiUrl +\n      this.c.endpoints.playDTMFToSession\n        .replace(/<%apiKey%>/g, this.c.apiKey)\n        .replace(/<%sessionId%>/g, opts.sessionId);\n  }\n  if (opts.connectionId) {\n    url =\n      this.c.apiUrl +\n      this.c.endpoints.playDTMFToClient\n        .replace(/<%apiKey%>/g, this.c.apiKey)\n        .replace(/<%sessionId%>/g, opts.sessionId)\n        .replace(/<%connectionId%>/g, opts.connectionId);\n  }\n\n  request.post(\n    {\n      url: url,\n      json: {\n        digits: opts.digits\n      },\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n\n      if (resp.statusCode === 200) {\n        // Success\n        return cb(null);\n      }\n\n      return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n    }\n  );\n};\n\nClient.prototype.forceMuteStream = function (opts, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.forceMuteStream\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%sessionId%>/g, opts.sessionId)\n      .replace(/<%streamId%>/g, opts.streamId);\n\n  request.post(\n    {\n      url: url,\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n\n      if (resp.statusCode === 200) {\n        // Success\n        return cb(null);\n      }\n\n      return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n    }\n  );\n};\n\nClient.prototype.forceMuteAll = function (opts, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.forceMute\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%sessionId%>/g, opts.sessionId);\n\n  opts.options.active = true;\n\n  request.post(\n    {\n      url: url,\n      json: opts.options,\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n\n      if (resp.statusCode === 200) {\n        // Success\n        return cb(null);\n      }\n\n      return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n    }\n  );\n};\n\nClient.prototype.disableForceMute = function (opts, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.forceMute\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%sessionId%>/g, opts.sessionId);\n\n  var options = {\n    active: false\n  };\n\n  request.post(\n    {\n      url: url,\n      json: options,\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n\n      if (resp.statusCode === 200) {\n        // Success\n        return cb(null);\n      }\n\n      return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n    }\n  );\n};\n\nClient.prototype.setArchiveLayout = function setArchiveLayout(opts, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.setArchiveLayout\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%archiveId%>/g, opts.archiveId);\n  request.put(\n    {\n      url: url,\n      headers: this.generateHeaders(),\n      json: true,\n      body: {\n        type: opts.type,\n        stylesheet: opts.stylesheet || undefined,\n        screenshareType: opts.screenshareType || undefined\n      }\n    },\n    function requestCallback(err, resp, body) {\n      if (err) {\n        return cb(new Error('The request failed: ' + err));\n      }\n      if (resp.statusCode === 200) {\n        return cb(null, body);\n      }\n      return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n    }\n  );\n};\n\nClient.prototype.startBroadcast = function (opts, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.startBroadcast.replace(/<%apiKey%>/g, this.c.apiKey);\n  request.post(\n    {\n      url: url,\n      json: opts,\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n\n      if (resp.statusCode === 200) {\n        // Success\n        return cb(null, JSON.stringify(body));\n      }\n\n      return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n    }\n  );\n};\n\nClient.prototype.patchBroadcast = function patchBroadcast(broadcastId, opts, cb) {\n  var url = this.c.apiUrl + this.c.endpoints.patchBroadcast.replace(/<%apiKey%>/g, this.c.apiKey)\n    .replace(/<%broadcastId%>/g, broadcastId);\n\n  request.patch({\n    url: url,\n    json: opts,\n    headers: this.generateHeaders()\n  }, function (err, resp, body) {\n    if (err) return cb(new Error('The request failed'));\n    if (resp.statusCode === 200) {\n      return cb(null, JSON.stringify(body));\n    }\n    return cb(new Error('(' + resp.statusCode + ') ' + JSON.stringify(body)));\n  });\n};\n\nClient.prototype.stopBroadcast = function (broadcastId, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.stopBroadcast\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%broadcastId%>/g, broadcastId);\n\n  request.post(\n    {\n      url: url,\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n\n      if (resp.statusCode === 200) {\n        // Success\n        return cb(null, body);\n      }\n\n      return cb(new Error('(' + resp.statusCode + ') ' + JSON.parse(body).message));\n    }\n  );\n};\n\nClient.prototype.getBroadcast = function getBroadcast(broadcastId, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.getBroadcast\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%broadcastId%>/g, broadcastId);\n  request.get(\n    {\n      url: url,\n      headers: this.generateHeaders()\n    },\n    function requestCallback(err, resp, body) {\n      if (err) {\n        return cb(new Error('The request failed: ' + err));\n      }\n      if (resp.statusCode === 200) {\n        return cb(null, body);\n      }\n      return cb(new Error('(' + resp.statusCode + ') ' + body ? body.message : ''));\n    }\n  );\n};\n\nClient.prototype.listBroadcasts = function listBroadcasts(queryString, cb) {\n  var baseUrl =\n    this.c.apiUrl +\n    this.c.endpoints.listBroadcasts.replace(/<%apiKey%>/g, this.c.apiKey);\n  var url = queryString.length > 0 ? baseUrl + '?' + queryString : baseUrl;\n  var parsedBody;\n  request.get(\n    {\n      url: url,\n      headers: this.generateHeaders()\n    },\n    function requestCallback(err, resp, body) {\n      if (err) {\n        return cb(new Error('The request failed: ' + err));\n      }\n      if (resp.statusCode === 200) {\n        parsedBody = JSON.parse(body);\n        return cb(\n          null,\n          parsedBody.items.map(function itemIterator(item) {\n            return new Broadcast(Client, JSON.stringify(item));\n          }),\n          parsedBody.count\n        );\n      }\n      return cb(new Error('(' + resp.statusCode + ') ' + body ? body.message : ''));\n    }\n  );\n};\n\nClient.prototype.setBroadcastLayout = function setBroadcastLayout(opts, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.setBroadcastLayout\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%broadcastId%>/g, opts.broadcastId);\n  request.put(\n    {\n      url: url,\n      headers: this.generateHeaders(),\n      json: true,\n      body: {\n        type: opts.type,\n        stylesheet: opts.stylesheet || undefined,\n        screenshareType: opts.screenshareType || undefined\n      }\n    },\n    function requestCallback(err, resp, body) {\n      if (err) {\n        return cb(new Error('The request failed: ' + err));\n      }\n      if (resp.statusCode === 200) {\n        return cb(null, body);\n      }\n      return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n    }\n  );\n};\n\nClient.prototype.setStreamClassLists = function setStreamClassLists(\n  sessionId,\n  classListArray,\n  cb\n) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.setStreamClassLists\n      .replace(/<%apiKey%>/, this.c.apiKey)\n      .replace(/<%sessionId%>/g, sessionId);\n  request.put(\n    {\n      url: url,\n      headers: this.generateHeaders(),\n      json: true,\n      body: {\n        items: classListArray\n      }\n    },\n    function requestCallback(err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n      // handle client errors\n      switch (resp.statusCode) {\n        case 200:\n          return cb(null, body);\n        case 400:\n          return cb(new Error('Invalid session ID or stream ID (400).'));\n        case 403:\n          return cb(new Error('Invalid API key or secret (403).'));\n        default:\n          if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n            // handle server errors\n            return cb(new Error('A server error occurred: (' +\n                  resp.statusCode +\n                  ') ' +\n                  JSON.stringify(body)));\n          }\n      }\n      return cb(new Error('An unexpected error occurred: (' +\n            resp.statusCode +\n            ') ' +\n            JSON.stringify(body)));\n    }\n  );\n};\n\nClient.prototype.dial = function (opts, cb) {\n  request.post(\n    {\n      // TODO: only works while apiUrl is always up to the domain, without the ending slash\n      url: this.c.apiUrl + this.c.endpoints.dial,\n      json: opts,\n      headers: this.generateHeaders()\n    },\n    function (err, resp, body) {\n      if (err) return cb(new Error('The request failed: ' + err));\n      // handle client errors\n      if (resp.statusCode === 400) {\n        if (body.code === 15204) {\n          return cb(new Error('SIP Interconnect for Video is not enabled in this project'));\n        }\n        return cb(new Error('Bad session ID, token, SIP credentials, or SIP URI (sip:user@domain.tld)'));\n      }\n\n      if (resp.statusCode === 403) {\n        return cb(new Error('Invalid API key or secret'));\n      }\n\n      if (resp.statusCode === 409) {\n        return cb(new Error('Only Routed Sessions are allowed to initiate SIP Calls.'));\n      }\n\n      // handle server errors\n      if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n        return cb(new Error('A server error occurred: (' + resp.statusCode + ') ' + body));\n      }\n\n      // Parse data from server\n      return cb(null, body);\n    }\n  );\n};\n\nClient.prototype.getStream = function getStream(sessionId, streamId, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.getStream\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%streamId%>/g, streamId)\n      .replace(/<%sessionId%>/g, sessionId);\n  request.get(\n    {\n      url: url,\n      headers: this.generateHeaders()\n    },\n    function requestCallback(err, resp, body) {\n      if (err) {\n        return cb(new Error('The request failed: ' + err));\n      }\n      if (resp.statusCode === 200) {\n        return cb(null, body);\n      }\n      return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n    }\n  );\n};\n\nClient.prototype.listStreams = function listStreams(sessionId, cb) {\n  var url =\n    this.c.apiUrl +\n    this.c.endpoints.listStreams\n      .replace(/<%apiKey%>/g, this.c.apiKey)\n      .replace(/<%sessionId%>/g, sessionId);\n  request.get(\n    {\n      url: url,\n      headers: this.generateHeaders()\n    },\n    function requestCallback(err, resp, body) {\n      if (err) {\n        return cb(new Error('The request failed: ' + err));\n      }\n      if (resp.statusCode === 200) {\n        return cb(\n          null,\n          JSON.parse(body).items.map(function itemIterator(item) {\n            return new Stream(JSON.stringify(item));\n          })\n        );\n      }\n      return cb(new Error('(' + resp.statusCode + ') ' + body.message));\n    }\n  );\n};\n\nClient.prototype.generateHeaders = function () {\n  return {\n    'User-Agent':\n      'OpenTok-Node-SDK/' +\n      pkg.version +\n      (this.c.uaAddendum ? ' ' + this.c.uaAddendum : ''),\n    'X-OPENTOK-AUTH': generateJwt(this.c),\n    Accept: 'application/json'\n  };\n};\n\nmodule.exports = Client;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}