{"ast":null,"code":"import _classCallCheck from\"/Users/megnabiederman/Desktop/GamerECSAMPLE/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/megnabiederman/Desktop/GamerECSAMPLE/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/megnabiederman/Desktop/GamerECSAMPLE/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/megnabiederman/Desktop/GamerECSAMPLE/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import'../style/Video.css';import{OTSession,OTPublisher,OTStreams,OTSubscriber}from'opentok-react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Stream=/*#__PURE__*/function(_React$Component){_inherits(Stream,_React$Component);var _super=_createSuper(Stream);function Stream(props){var _this;_classCallCheck(this,Stream);_this=_super.call(this,props);_this.onSessionError=function(error){_this.setState({error:error});};_this.onPublish=function(){console.log('Publish Success');};_this.onPublishError=function(error){_this.setState({error:error});};_this.onSubscribe=function(){console.log('Subscribe Success');};_this.onSubscribeError=function(error){_this.setState({error:error});};_this.toggleVideo=function(){_this.setState(function(state){return{publishVideo:!state.publishVideo};});};_this.state={error:null,connection:'Connecting',publishVideo:true,apiKey:\"\",sessionId:\"\",token:\"\"};_this.sessionEventHandlers={sessionConnected:function sessionConnected(){_this.setState({connection:'Connected'});},sessionDisconnected:function sessionDisconnected(){_this.setState({connection:'Disconnected'});},sessionReconnected:function sessionReconnected(){_this.setState({connection:'Reconnected'});},sessionReconnecting:function sessionReconnecting(){_this.setState({connection:'Reconnecting'});}};_this.publisherEventHandlers={accessDenied:function accessDenied(){console.log('User denied access to media source');},streamCreated:function streamCreated(){console.log('Publisher stream created');},streamDestroyed:function streamDestroyed(_ref){var reason=_ref.reason;console.log(\"Publisher stream destroyed because: \".concat(reason));}};_this.subscriberEventHandlers={videoEnabled:function videoEnabled(){console.log('Subscriber video enabled');},videoDisabled:function videoDisabled(){console.log('Subscriber video disabled');}};_this.componentDidMount();return _this;}_createClass(Stream,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch(\"/api\").then(function(res){return res.json();}).then(function(data){return _this2.setState({apiKey:data.apiKey,sessionId:data.sessionId,token:data.token});}).catch(function(err){console.error('Failed to get session creddentials',err);alert('Failed to get opentok sessionId and token');});}},{key:\"render\",value:function render(){var _this$state=this.state,apiKey=_this$state.apiKey,sessionId=_this$state.sessionId,token=_this$state.token,publishVideo=_this$state.publishVideo;//alert(apiKey);\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"Video\",children:apiKey!==\"\"&&sessionId!==\"\"&&token!==\"\"&&/*#__PURE__*/_jsxs(OTSession,{apiKey:apiKey,sessionId:sessionId,token:token,onError:this.onSessionError,eventHandlers:this.sessionEventHandlers,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"OT_publisher\",children:[/*#__PURE__*/_jsx(OTPublisher,{properties:{publishVideo:publishVideo,width:150,height:120},onPublish:this.onPublish,onError:this.onPublishError,eventHandlers:this.publisherEventHandlers}),/*#__PURE__*/_jsx(\"div\",{className:\"videoButton\",children:/*#__PURE__*/_jsxs(\"button\",{id:\"videoButton\",onClick:this.toggleVideo,children:[publishVideo?'Disable':'Enable',\" Video\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"OT_subscriber\",children:/*#__PURE__*/_jsx(OTStreams,{children:/*#__PURE__*/_jsx(OTSubscriber,{properties:{width:850,height:475},onSubscribe:this.onSubscribe,onError:this.onSubscribeError,eventHandlers:this.subscriberEventHandlers})})})]})});}}]);return Stream;}(React.Component);export{Stream as default};","map":{"version":3,"names":["React","OTSession","OTPublisher","OTStreams","OTSubscriber","Stream","props","onSessionError","error","setState","onPublish","console","log","onPublishError","onSubscribe","onSubscribeError","toggleVideo","state","publishVideo","connection","apiKey","sessionId","token","sessionEventHandlers","sessionConnected","sessionDisconnected","sessionReconnected","sessionReconnecting","publisherEventHandlers","accessDenied","streamCreated","streamDestroyed","reason","subscriberEventHandlers","videoEnabled","videoDisabled","componentDidMount","fetch","then","res","json","data","catch","err","alert","width","height","Component"],"sources":["/Users/megnabiederman/Desktop/GamerECSAMPLE/client/src/components/Stream.js"],"sourcesContent":["import React from 'react';\nimport '../style/Video.css'\nimport { OTSession, OTPublisher, OTStreams, OTSubscriber } from 'opentok-react';\n\n\nexport default class Stream extends React.Component {\n  componentDidMount(){\n    fetch(\"/api\")\n      .then((res) => res.json())\n      .then((data) => this.setState({apiKey:data.apiKey, sessionId:data.sessionId, token:data.token}))\n      .catch((err) => {\n        console.error('Failed to get session creddentials', err);\n        alert('Failed to get opentok sessionId and token');\n      });\n  }\n  \n  constructor(props) {\n    super(props);\n    \n    this.state = {\n      error: null,\n      connection: 'Connecting',\n      publishVideo: true,\n      apiKey:\"\",\n      sessionId:\"\",\n      token:\"\",\n    };\n\n    this.sessionEventHandlers = {\n      sessionConnected: () => {\n        this.setState({ connection: 'Connected' });\n      },\n      sessionDisconnected: () => {\n        this.setState({ connection: 'Disconnected' });\n      },\n      sessionReconnected: () => {\n        this.setState({ connection: 'Reconnected' });\n      },\n      sessionReconnecting: () => {\n        this.setState({ connection: 'Reconnecting' });\n      },\n    };\n\n    this.publisherEventHandlers = {\n      accessDenied: () => {\n        console.log('User denied access to media source');\n      },\n      streamCreated: () => {\n        console.log('Publisher stream created');\n      },\n      streamDestroyed: ({ reason }) => {\n        console.log(`Publisher stream destroyed because: ${reason}`);\n      },\n    };\n\n    this.subscriberEventHandlers = {\n      videoEnabled: () => {\n        console.log('Subscriber video enabled');\n      },\n      videoDisabled: () => {\n        console.log('Subscriber video disabled');\n      },\n    };\n    this.componentDidMount();\n  }\n\n\n  onSessionError = error => {\n    this.setState({ error });\n  };\n\n  onPublish = () => {\n    console.log('Publish Success');\n  };\n\n  onPublishError = error => {\n    this.setState({ error });\n  };\n\n  onSubscribe = () => {\n    console.log('Subscribe Success');\n  };\n\n  onSubscribeError = error => {\n    this.setState({ error });\n  };\n\n  toggleVideo = () => {\n    this.setState(state => ({\n      publishVideo: !state.publishVideo,\n    }));\n  };\n\n  \n  render(){\n    \n    const { apiKey, sessionId, token, publishVideo } = this.state;\n    //alert(apiKey);\n    return(\n      <div className='Video'>\n        {apiKey !== \"\" && sessionId !== \"\" && token !== \"\" && \n          \n          <OTSession\n            apiKey={apiKey}\n            sessionId={sessionId}\n            token={token}\n            onError={this.onSessionError}\n            eventHandlers={this.sessionEventHandlers}\n          >\n            <div className='OT_publisher'>\n              <OTPublisher\n                properties={{ publishVideo, width:150,height:120 }}\n                onPublish={this.onPublish}\n                onError={this.onPublishError}\n                eventHandlers={this.publisherEventHandlers}\n              />\n              <div className='videoButton'>\n                <button id=\"videoButton\" onClick={this.toggleVideo}>\n                {publishVideo ? 'Disable' : 'Enable'} Video\n                </button>\n              </div>\n            </div>\n            <div className='OT_subscriber'>\n            <OTStreams>\n              \n              <OTSubscriber\n                properties={{ width: 850, height: 475 }}\n                onSubscribe={this.onSubscribe}\n                onError={this.onSubscribeError}\n                eventHandlers={this.subscriberEventHandlers}\n              />\n              \n            </OTStreams>\n            </div>\n\n          </OTSession>\n        }\n        </div>\n    );\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}